{
  "pseudo_non_stream": {
    "description": "是否启用假非流",
    "type": "bool",
    "default": true,
    "hint": "开启后，将 AstrBot 发来的非流式请求强制改为流式发给上游，获取 SSE 响应后重组为非流式 JSON 返回，防止因无响应超时导致的连接断开"
  },
  "debug": {
    "description": "启用调试日志",
    "type": "bool",
    "default": false,
    "hint": "记录每个请求的方法、路径、目标、请求体和耗时"
  },
  "port": {
    "description": "本地监听端口",
    "type": "int",
    "default": 23456,
    "hint": "代理服务器使用的本地端口"
  },
  "request_timeout": {
    "description": "上游请求超时（秒）",
    "type": "float",
    "default": 120.0,
    "hint": "全局连接/读取超时，防止上游连接永久挂起"
  },
  "tool_error_patterns": {
    "description": "额外的工具错误识别正则",
    "type": "list",
    "default": [],
    "hint": "自定义正则表达式列表，会追加到内置默认规则上（不会覆盖）；匹配任一即触发 Layer 2 修复"
  },
  "fix_retries": {
    "description": "最多重试次数",
    "type": "int",
    "default": 1,
    "hint": "工具调用参数为空或提取失败时，注入提示(若启用了fc增强)并重试的最大次数；0 表示禁用；适用于所有提供商"
  },
  "extract_args": {
    "description": "启用 FC 增强（工具参数 JSON 提取）",
    "type": "bool",
    "default": false,
    "hint": "开启后，若工具调用参数为空，无效，或失败，会额外发送一条请求让模型单独输出 JSON 参数，再注入回原响应（适用于 Gemini/OpenAI/Claude）"
  },
  "providers": {
    "type": "template_list",
    "description": "提供商路由列表",
    "templates": {
      "provider": {
        "name": "提供商",
        "hint": "将 AstrBot 提供商的 base_url 设置为 http://localhost:<端口>/<路由名称>",
        "items": {
          "route_name": {
            "description": "路由名称",
            "type": "string",
            "hint": "用于本地路径：/<路由名称>"
          },
          "target_url": {
            "description": "上游 API 基础 URL",
            "type": "string",
            "default": "https://api.openai.com",
            "hint": "只需填写基础 URL，端点路径会自动匹配"
          },
          "forward_url": {
            "description": "生成的本地转发 URL",
            "type": "string",
            "default": "",
            "hint": "由端口 + 路由名称自动生成"
          },
          "proxy_url": {
            "description": "HTTP 代理 URL（可选）",
            "type": "string",
            "default": "",
            "hint": "例如：http://127.0.0.1:7890"
          },
          "pseudo_non_stream": {
            "description": "假非流（路由级别覆盖）",
            "type": "bool",
            "default": true,
            "hint": "Ollama 等本地模型请设为 false（Ollama 流式接口会静默丢弃工具调用）；OpenAI / Gemini / Claude 等云端接口保持 true"
          }
        }
      }
    }
  }
}
